{"version":3,"file":"content.b88e9a781b0ac2731747.hot-update.js","mappings":"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","sources":["webpack://tean-mate/./4-content/content.js","webpack://tean-mate/webpack/runtime/getFullHash"],"sourcesContent":["import HighlightBox from \"../2-features/TTS/HighlightBox.js\";\nimport TextExtractor from \"../2-features/TTS/TextExtractor.js\";\nimport SpeechHandler from \"../2-features/TTS/SpeechHandler.js\";\nimport LinkHandler from \"../2-features/TTS/LinkHandler.js\";\n\nclass ContentHandler {\n    constructor() {\n        this.sections = [];\n        this.currentIndex = 0;\n        this.pastBorderStyle = \"\";\n        this.pastBackgroundStyle = \"\";\n\n        this.highlightBox = new HighlightBox();\n        this.textExtractor = new TextExtractor();\n        this.speechHandler = new SpeechHandler();\n        this.linkHandler = new LinkHandler();\n        this.currentElement = null;\n        this.elements = Array.from(document.body.querySelectorAll('*'));\n\n        chrome.runtime.onMessage.addListener(this.handleMessage.bind(this));\n    }\n\n    navigateElement(startIndex, direction) {\n        const step = direction === \"next\" ? 1 : -1;\n\n        for (let i = startIndex + step; i >= 0 && i < this.elements.length; i += step) {\n            const element = this.elements[i];\n            if (this.isElementVisible(element)) {\n                const text = this.textExtractor.extractText(element);\n                if (text.trim()) {\n                    this.currentIndex = i;\n                    return { element, text };\n                }\n            }\n        }\n        return null; // No more valid elements\n    }\n\n    getNextElement(startIndex) {\n        return this.navigateElement(startIndex, \"next\");\n    }\n\n    prevElement(startIndex) {\n        return this.navigateElement(startIndex, \"previous\");\n    }\n\n    speakCurrentSection() {\n        if (!this.currentElement) {\n            this.currentElement = this.getNextElement(this.currentIndex);\n        }\n\n        if (!this.currentElement) {\n            console.log(\"No more elements to process.\");\n            return;\n        }\n\n        const { element, text } = this.currentElement;\n\n        // Only highlight if not already highlighted\n        if (this.highlightBox.currentlyHighlighted !== element) {\n            this.highlightBox.removeHighlight(this.highlightBox.currentlyHighlighted);\n            this.highlightBox.addHighlight(element);\n        }\n\n        this.speechHandler.speak(text, () => {\n            this.highlightBox.removeHighlight(element);\n            this.currentIndex++;\n            this.currentElement = null; // Prepare for the next element\n            this.speakCurrentSection();\n        });\n    }\n\n    handleMessage(request) {\n        if (request.action === \"extractText\") {\n            this.currentIndex = 0;\n            this.currentElement = null;\n            this.speakCurrentSection();\n        } else if (request.action === \"skipToNext\") {\n            this.speechHandler.stop();\n            this.highlightBox.removeHighlight(this.currentElement?.element);\n            this.currentElement = this.getNextElement(this.currentIndex + 1);\n            this.speakCurrentSection();\n        } else if (request.action === \"skipToPrevious\") {\n            this.speechHandler.stop();\n            this.highlightBox.removeHighlight(this.currentElement?.element);\n            this.currentElement = this.prevElement(this.currentIndex - 1);\n            this.speakCurrentSection();\n        } else if (request.action === \"toggleReading\") {\n            if (this.speechHandler.isSpeaking) {\n                this.speechHandler.stop();\n                this.highlightBox.removeHighlight(this.currentElement?.element);\n            } else {\n                this.speakCurrentSection();\n            }\n        } else if (request.action === \"accessLink\") {\n            if (this.currentElement) {\n                this.linkHandler.accessLink(this.currentElement.element);\n                this.speechHandler.stop();\n            }\n        }\n    }\n\n    isElementVisible(element) {\n        const rect = element.getBoundingClientRect();\n        const isInViewport = rect.top >= 0 &&\n                             rect.left >= 0 &&\n                             rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n                             rect.right <= (window.innerWidth || document.documentElement.clientWidth);\n        const style = window.getComputedStyle(element);\n        const isNotHidden = style.visibility !== \"hidden\" &&\n                            style.display !== \"none\" &&\n                            style.opacity !== \"0\";\n        return isInViewport && isNotHidden;\n    }\n}\n\n// Instantiate the content handler\nnew ContentHandler();\n","__webpack_require__.h = () => (\"7ad4d210995c0f7b09d2\")"],"names":["HighlightBox","TextExtractor","SpeechHandler","LinkHandler","ContentHandler","_context","_classCallCheck","sections","currentIndex","pastBorderStyle","pastBackgroundStyle","highlightBox","textExtractor","speechHandler","linkHandler","currentElement","elements","_Array$from","document","body","querySelectorAll","chrome","runtime","onMessage","addListener","_bindInstanceProperty","handleMessage","call","_createClass","key","value","navigateElement","startIndex","direction","step","i","length","element","isElementVisible","text","extractText","_trimInstanceProperty","getNextElement","prevElement","speakCurrentSection","_this","console","log","_this$currentElement","currentlyHighlighted","removeHighlight","addHighlight","speak","request","action","_this$currentElement2","stop","_this$currentElement3","isSpeaking","_this$currentElement4","accessLink","rect","getBoundingClientRect","isInViewport","top","left","bottom","window","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","style","getComputedStyle","isNotHidden","visibility","display","opacity"],"sourceRoot":""}